(this["webpackJsonpvk-rate-host"]=this["webpackJsonpvk-rate-host"]||[]).push([[7],{106:function(e,t,n){"use strict";n.r(t);var r,a=n(0),o=n.n(a),s=n(28),i=n.n(s),c=n(15),u=n(4),l=n.n(u),d=n(10),p=n(2),m=n(62),h=n(5),_=n(11);!function(e){e.SET_USER_TYPE="SET_USER_TYPE",e.SET_HOSTS_LIST="SET_HOSTS_LIST",e.SET_HOST_INFO="SET_HOST_INFO",e.SET_HOST_COMMENTS="SET_HOST_COMMENTS",e.SET_ACTIVE_DIALOG="SET_ACTIVE_DIALOG",e.SHOW_PRELOADER="SHOW_PRELOADER",e.HIDE_PRELOADER="HIDE_PRELOADER"}(r||(r={}));var f=function(e){return{type:r.SET_ACTIVE_DIALOG,payload:e}},E=function(e){return e?{type:r.SHOW_PRELOADER}:{type:r.HIDE_PRELOADER}},b=function(){var e=Object(c.b)(),t=Object(a.useCallback)((function(){e(f(null))}),[e]),n=Object(c.c)((function(e){return e.globals.activeDialog}));if(Object(c.c)((function(e){return e.globals.preloaders})))return o.a.createElement(p.o,{isOpen:!0,translucent:!0});if(!n)return null;var r={};switch(n.type){case"message":r=Object(_.a)({header:n.title||Object({NODE_ENV:"production",PUBLIC_URL:".",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,REACT_APP_VERSION:"0.0.2",REACT_APP_API_URL:"https://api.somecrap.ru/host_rate/request.php",REACT_APP_NAME:"Rate Host",REACT_APP_DESCRIPTION:"Cool VK-mini-app",REACT_APP_REPORT_ERRORS:"false",REACT_APP_ISSUES_LINK:"https://github.com/zardoy/vk-rate-host/issues",REACT_APP_MOCK_API_ENABLED:"true",REACT_APP_MOCK_API_SPEED:"high"}).RATE_APP_NAME,message:n.message,buttons:[{text:"OK",role:"cancel"}]},n.handler?{onDidDismiss:n.handler}:{});break;case"destruction":r={header:n.title,message:n.message,buttons:[{text:"OK",role:"cancel"},{text:n.confirmText,role:"destructive",handler:n.confirmHandler}]}}return o.a.createElement(p.b,Object.assign({isOpen:!0,backdropDismiss:!1,onDidDismiss:t,translucent:!0},r))},j=n(70),y=n(73),O=n(36),g=n(7),v=n(12),T=n(13),S=n(72),w=function(e){Object(v.a)(n,e);var t=Object(T.a)(n);function n(e,r,a){var o;return Object(g.a)(this,n),(o=t.call(this,e)).message=e,o.error_code=r,o.method_name=a,o}return n}(Object(S.a)(Error)),k=["\u0414\u0430\u0432\u043d\u043e \u0432\u044b\u044f\u0441\u043d\u0435\u043d\u043e, \u0447\u0442\u043e \u043f\u0440\u0438 \u043e\u0446\u0435\u043d\u043a\u0435 \u0434\u0438\u0437\u0430\u0439\u043d\u0430 \u0438 \u043a\u043e\u043c\u043f\u043e\u0437\u0438\u0446\u0438\u0438 \u0447\u0438\u0442\u0430\u0435\u043c\u044b\u0439 \u0442\u0435\u043a\u0441\u0442 \u043c\u0435\u0448\u0430\u0435\u0442 \u0441\u043e\u0441\u0440\u0435\u0434\u043e\u0442\u043e\u0447\u0438\u0442\u044c\u0441\u044f.",'\u041c\u043d\u043e\u0433\u0438\u0435 \u043f\u0440\u043e\u0433\u0440\u0430\u043c\u043c\u044b \u044d\u043b\u0435\u043a\u0442\u0440\u043e\u043d\u043d\u043e\u0439 \u0432\u0451\u0440\u0441\u0442\u043a\u0438 \u0438 \u0440\u0435\u0434\u0430\u043a\u0442\u043e\u0440\u044b HTML \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u044e\u0442 Lorem Ipsum \u0432 \u043a\u0430\u0447\u0435\u0441\u0442\u0432\u0435 \u0442\u0435\u043a\u0441\u0442\u0430 \u043f\u043e \u0443\u043c\u043e\u043b\u0447\u0430\u043d\u0438\u044e, \u0442\u0430\u043a \u0447\u0442\u043e \u043f\u043e\u0438\u0441\u043a \u043f\u043e \u043a\u043b\u044e\u0447\u0435\u0432\u044b\u043c \u0441\u043b\u043e\u0432\u0430\u043c "lorem ipsum" \u0441\u0440\u0430\u0437\u0443 \u043f\u043e\u043a\u0430\u0437\u044b\u0432\u0430\u0435\u0442, \u043a\u0430\u043a \u043c\u043d\u043e\u0433\u043e \u0432\u0435\u0431-\u0441\u0442\u0440\u0430\u043d\u0438\u0446 \u0432\u0441\u0451 \u0435\u0449\u0451 \u0434\u043e\u0436\u0438\u0434\u0430\u044e\u0442\u0441\u044f \u0441\u0432\u043e\u0435\u0433\u043e \u043d\u0430\u0441\u0442\u043e\u044f\u0449\u0435\u0433\u043e \u0440\u043e\u0436\u0434\u0435\u043d\u0438\u044f.'],R=["yura","text","test","host"],A="high".toLowerCase(),D=function(e){return new Promise((function(t){return setTimeout(t,e)}))},x=function(e,t){return Math.floor(Math.random()*(t-e))+e},L=function(e){return e[x(0,e.length)]},P={"app.init":function(){return Object(d.a)(l.a.mark((function e(){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",{user_type:L(["user","host_member","host_owner"])});case 1:case"end":return e.stop()}}),e)})))()},"app.GetRatingList":function(e,t){return Object(d.a)(l.a.mark((function e(){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Array(100).fill(null).map((function(e,t){return{host_id:t,host_name:"".concat(L(R)," ").concat(x(0,2)?L(R):""),host_site:L(R)+"-"+L(R)+".com",host_rating:(100-t)/10}})));case 1:case"end":return e.stop()}}),e)})))()},"host.GetInfo":function(e,t){return Object(d.a)(l.a.mark((function t(){var n,r,a,o;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:for(e.host_id,n={billing:0,cpu:0,network:0,ram:0,support:0},r=0,a=Object.keys(n);r<a.length;r++)o=a[r],n[o]=Math.round(x(1,100)/10);return t.abrupt("return",{host_description:L(k),ratings:n});case 4:case"end":return t.stop()}}),t)})))()},"host.GetComments":function(e,t){return Object(d.a)(l.a.mark((function t(){return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.host_id,t.abrupt("return",new Array(100).fill(null).map((function(e,t){return{id:t,time:0,user_id:0,reputation:500-t,text:L(k).split(" ").slice(0,3).join(" "),answers:[],rating:x(0,10)}})));case 2:case"end":return t.stop()}}),t)})))()},"host.AddOrEditRating":void 0,"host.AddAnswer":void 0,"host.EditAnswer":void 0,"host.SendUserReaction":void 0,"host.DeleteContent":void 0,"hostMembers.Add":void 0,"hostMembers.Delete":void 0},C=function(){var e=Object(d.a)(l.a.mark((function e(t,n,r){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("Requesting Method...",t),e.next=3,D("high"===A?800:"low"===A?4e3:0);case 3:return e.next=5,P[t](n,r);case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}(),I=function(){var e=Object(c.b)();return Object(a.useCallback)(function(){var t=Object(d.a)(l.a.mark((function t(n,r){var a,o,s,i,c,u,d,p,m,h,b,g,v,T,S;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(a=r.fetchOptions,o=void 0===a?{}:a,s=r.showModalLoader,i=void 0===s||s,c=r.handleError,u=void 0===c||c,d=Object(y.a)(r,["fetchOptions","showModalLoader","handleError"]),i&&e(E(!0)),p=new FormData,Object.entries(d).forEach((function(e){var t=Object(j.a)(e,2),n=t[0],r=t[1];return p.append(n,r)})),t.prev=4,(m="https://api.somecrap.ru/host_rate/request.php")&&"true"!=="true".toLowerCase()){t.next=10;break}return t.next=9,C(n,d,o.signal);case 9:return t.abrupt("return",t.sent);case 10:return(h=new URL(m+"?"+window.location.search.slice(1))).searchParams.append("method",n),t.next=14,fetch(h.toString(),Object(_.a)({method:p.keys.length?"post":"get",body:p.keys.length?p:null},o));case 14:return b=t.sent,t.next=17,b.json();case 17:if(!("error"in(g=t.sent))){t.next=21;break}throw v=g.error,T=v.code,S=v.message,new w(S,T,n);case 21:return t.abrupt("return",g);case 24:if(t.prev=24,t.t0=t.catch(4),"AbortError"!==t.t0.name){t.next=28;break}return t.abrupt("return",{error:t.t0});case 28:if(!u){t.next=32;break}e(f({type:"message",title:O.a.t("Server Error"),message:t.t0 instanceof w?O.a.t(t.t0.error_code.toString(),{ns:"serverErrorCodes",defaultValue:t.t0.message}):t.t0.message})),t.next=33;break;case 32:throw t.t0;case 33:return t.abrupt("return",{error:t.t0});case 35:return t.prev=35,i&&e(E(!1)),t.finish(35);case 38:case"end":return t.stop()}}),t,null,[[4,24,35,38]])})));return function(e,n){return t.apply(this,arguments)}}(),[e])},H=n(43),M=n.n(H),N=function(e){switch(e.detail.type){case"VKWebAppUpdateConfig":!function(e){var t="client_dark"===e||"space_gray"===e,n=document.body;t?n.classList.add("dark"):n.classList.remove("dark")}(e.detail.data.scheme)}},U=function(){return o.a.createElement(p.q,null,o.a.createElement(p.i,null,o.a.createElement(p.w,null,o.a.createElement(p.v,null,"Rate Host"))),o.a.createElement(p.g,null,o.a.createElement(p.h,{horizontal:"center",vertical:"center"},o.a.createElement(p.u,null))))},V=n(192),K=function(e){var t=e.match,n=Object(c.b)(),s=Object(V.a)().t,i=I(),u=+t.params.rating_index,m=Object(c.c)((function(e){return e.hosts.hostsRatingList[u]})),h=Object(c.c)((function(e){return e.hosts.hostsDetailedData[m.host_id]}));return Object(a.useEffect)((function(){var e=new AbortController;return Object(d.a)(l.a.mark((function t(){var a;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(h){t.next=7;break}return t.next=3,i("host.GetInfo",{host_id:m.host_id,fetchOptions:{signal:e.signal}});case 3:if(!("error"in(a=t.sent))){t.next=6;break}return t.abrupt("return");case 6:n((o=u,s=a,{type:r.SET_HOST_INFO,payload:{host_id:o,host_data:s}}));case 7:case"end":return t.stop()}var o,s}),t)})))(),function(){e.abort()}}),[i,u,h,m.host_id,n]),o.a.createElement(p.q,null,o.a.createElement(p.i,null,o.a.createElement(p.w,null,o.a.createElement(p.f,null,o.a.createElement(p.d,{text:s("Back"),defaultHref:"/"})),o.a.createElement(p.v,null,m.host_site))),o.a.createElement(p.g,null,o.a.createElement("p",null,h&&h.host_description)))},W=n(17),F=function(){var e=Object(c.b)(),t=Object(V.a)().t,n=I(),s=Object(c.c)((function(e){return e.hosts.ratingLastUpdate})),i=Object(c.c)((function(e){return e.hosts.hostsRatingList})),u=Object(a.useCallback)((function(t){e(f({type:"destruction",message:"\u0412\u044b \u0443\u0432\u0435\u0440\u0435\u043d\u044b, \u0447\u0442\u043e \u0445\u043e\u0442\u0438\u0442\u0435 \u0443\u0434\u0430\u043b\u0438\u0442\u044c \u0432\u0441\u0435?",confirmHandler:function(){},confirmText:"\u0434\u0430\u0442",title:"DELETE?"}))}),[e]),m=Object(a.useCallback)(Object(d.a)(l.a.mark((function t(){var a;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n("app.GetRatingList",{});case 2:if(!("error"in(a=t.sent))){t.next=5;break}return t.abrupt("return");case 5:e((o=(o=a).map((function(e){return Object(_.a)(Object(_.a)({},e),{},{host_site:e.host_site.replace(/^https?:\/\//i,"")})})),{type:r.SET_HOSTS_LIST,payload:o}));case 6:case"end":return t.stop()}var o}),t)}))),[n,e]);return Object(a.useEffect)((function(){(!s||(Date.now()-s)/1e3/60/60/24>=1)&&m()}),[m,s]),o.a.createElement(p.q,null,o.a.createElement(p.i,{translucent:!0},o.a.createElement(p.w,null,o.a.createElement(p.f,null,o.a.createElement(p.e,{slot:"start"},o.a.createElement(p.j,{slot:"icon-only",icon:W.h}))),o.a.createElement(p.v,null,t("Hosts Rating")))),o.a.createElement(p.g,null,o.a.createElement(p.s,{onIonChange:u,value:"rating"},o.a.createElement(p.t,{value:"rating"},o.a.createElement(p.l,null,t("Rating"))),o.a.createElement(p.t,{value:""},o.a.createElement(p.l,null,t("My Reviews")))),s?o.a.createElement(p.n,null,i.map((function(e,t){var n=e.host_id,r=e.host_rating,a=e.host_site,s=e.host_name;return o.a.createElement(p.k,{routerLink:"/host/"+t,key:n,lines:"full"},o.a.createElement(p.p,{slot:"start",className:"host_rating"},o.a.createElement("h4",null,t+1)),o.a.createElement(p.l,null,o.a.createElement("h3",null,s),o.a.createElement("p",null,a)),o.a.createElement(p.p,{slot:"end"},r.toFixed(1),o.a.createElement(p.j,{icon:W.o,style:{verticalAlign:"text-top",marginLeft:"5px"}})))}))):null))};(F=o.a.memo(F)).displayName="Rating";var G=F,q=function(e){var t=e.callback,n=Object(V.a)().t;return o.a.createElement(p.q,null,o.a.createElement(p.i,null,o.a.createElement(p.w,null,n("Load Failed"))),o.a.createElement(p.g,null,o.a.createElement(p.e,{expand:"block",onClick:t},n("Reload Data"))))},B=function(){Object(a.useEffect)((function(){return M.a.send("VKWebAppInit"),M.a.subscribe(N),function(){M.a.unsubscribe(N)}}),[]);var e=Object(c.b)(),t=I(),n=Object(a.useCallback)(Object(d.a)(l.a.mark((function n(){var a;return l.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t("app.init",{});case 2:if(!("error"in(a=n.sent))){n.next=5;break}return n.abrupt("return");case 5:e((o=a.user_type,{type:r.SET_USER_TYPE,payload:o}));case 6:case"end":return n.stop()}var o}),n)}))),[e,t]);return Object(a.useEffect)((function(){n()}),[n]),o.a.createElement(p.c,null,o.a.createElement(a.Suspense,{fallback:o.a.createElement(U,null)},o.a.createElement(b,null),o.a.createElement(m.a,null,o.a.createElement(p.r,null,o.a.createElement(h.c,{path:"/rating",component:G,exact:!0}),o.a.createElement(h.c,{path:"/host/:rating_index",component:K,exact:!0}),o.a.createElement(h.c,{path:"/reloadapp",render:function(){return o.a.createElement(q,{callback:n})},exact:!0}),o.a.createElement(h.b,{from:"/",to:"/rating"})))))},Y=n(27),z=n(66),J=n(67),Q={preloaders:0,activeDialog:null},X=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Q,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case r.SET_ACTIVE_DIALOG:return Object(_.a)(Object(_.a)({},e),{},{activeDialog:t.payload});case r.SHOW_PRELOADER:return Object(_.a)(Object(_.a)({},e),{},{preloaders:e.preloaders+1});case r.HIDE_PRELOADER:return Object(_.a)(Object(_.a)({},e),{},{preloaders:e.preloaders-1});default:return e}},Z=n(18),$={ratingLastUpdate:null,hostsRatingList:[],hostsDetailedData:{}},ee={userType:null},te=Object(Y.combineReducers)({user:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ee,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case r.SET_USER_TYPE:return Object(_.a)(Object(_.a)({},e),{},{userType:t.payload});default:return e}},hosts:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:$,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case r.SET_HOSTS_LIST:return Object(_.a)(Object(_.a)({},e),{},{hostsRatingList:t.payload,ratingLastUpdate:Date.now()});case r.SET_HOST_INFO:var n=t.payload,a=n.host_id,o=n.host_data;return Object(_.a)(Object(_.a)({},e),{},{hostsDetailedData:Object(_.a)(Object(Z.a)({},a,o),e.hostsDetailedData)});default:return e}},hostComments:X,globals:X}),ne=Object(Y.createStore)(te,Object(z.composeWithDevTools)(Object(Y.applyMiddleware)(J.a))),re=n(68),ae=n(37),oe=function(e){var t="vk_"+e;return new URL(window.location.toString()).searchParams.get(t)},se={get vkIsDesktopVersion(){return"desktop_web"===oe("platform")},get VKLanguage(){return oe("language")||window.navigator.language||"en"}};O.a.use(re.a).use(ae.e).init({lng:se.VKLanguage,fallbackLng:"en",debug:!1,interpolation:{escapeValue:!1},defaultNS:"app",lowerCaseLng:!0,backend:{loadPath:"./assets/locales/{{lng}}.json"}});n(94),n(95),n(96),n(97),n(98),n(99),n(100),n(101),n(102),n(103),n(104),n(105);i.a.render(o.a.createElement(c.a,{store:ne},o.a.createElement(B,null)),document.getElementById("root"))},75:function(e,t,n){e.exports=n(106)},85:function(e,t,n){var r={"./ion-action-sheet-ios.entry.js":[110,31],"./ion-action-sheet-md.entry.js":[111,32],"./ion-alert-ios.entry.js":[112,33],"./ion-alert-md.entry.js":[113,34],"./ion-app_8-ios.entry.js":[114,13],"./ion-app_8-md.entry.js":[115,14],"./ion-avatar_3-ios.entry.js":[116,35],"./ion-avatar_3-md.entry.js":[117,36],"./ion-back-button-ios.entry.js":[118,37],"./ion-back-button-md.entry.js":[119,38],"./ion-backdrop-ios.entry.js":[120,79],"./ion-backdrop-md.entry.js":[121,80],"./ion-button_2-ios.entry.js":[122,39],"./ion-button_2-md.entry.js":[123,40],"./ion-card_5-ios.entry.js":[124,41],"./ion-card_5-md.entry.js":[125,42],"./ion-checkbox-ios.entry.js":[126,43],"./ion-checkbox-md.entry.js":[127,44],"./ion-chip-ios.entry.js":[128,45],"./ion-chip-md.entry.js":[129,46],"./ion-col_3.entry.js":[130,81],"./ion-datetime_3-ios.entry.js":[131,19],"./ion-datetime_3-md.entry.js":[132,20],"./ion-fab_3-ios.entry.js":[133,47],"./ion-fab_3-md.entry.js":[134,48],"./ion-img.entry.js":[135,82],"./ion-infinite-scroll_2-ios.entry.js":[136,83],"./ion-infinite-scroll_2-md.entry.js":[137,84],"./ion-input-ios.entry.js":[138,49],"./ion-input-md.entry.js":[139,50],"./ion-item-option_3-ios.entry.js":[140,51],"./ion-item-option_3-md.entry.js":[141,52],"./ion-item_8-ios.entry.js":[142,53],"./ion-item_8-md.entry.js":[143,54],"./ion-loading-ios.entry.js":[144,55],"./ion-loading-md.entry.js":[145,56],"./ion-menu_3-ios.entry.js":[146,57],"./ion-menu_3-md.entry.js":[147,58],"./ion-modal-ios.entry.js":[148,15],"./ion-modal-md.entry.js":[149,16],"./ion-nav_2.entry.js":[150,27],"./ion-popover-ios.entry.js":[151,17],"./ion-popover-md.entry.js":[152,18],"./ion-progress-bar-ios.entry.js":[153,59],"./ion-progress-bar-md.entry.js":[154,60],"./ion-radio_2-ios.entry.js":[155,61],"./ion-radio_2-md.entry.js":[156,62],"./ion-range-ios.entry.js":[157,63],"./ion-range-md.entry.js":[158,64],"./ion-refresher_2-ios.entry.js":[159,21],"./ion-refresher_2-md.entry.js":[160,22],"./ion-reorder_2-ios.entry.js":[161,29],"./ion-reorder_2-md.entry.js":[162,30],"./ion-ripple-effect.entry.js":[163,85],"./ion-route_4.entry.js":[164,65],"./ion-searchbar-ios.entry.js":[165,66],"./ion-searchbar-md.entry.js":[166,67],"./ion-segment_2-ios.entry.js":[167,68],"./ion-segment_2-md.entry.js":[168,69],"./ion-select_3-ios.entry.js":[169,70],"./ion-select_3-md.entry.js":[170,71],"./ion-slide_2-ios.entry.js":[171,86],"./ion-slide_2-md.entry.js":[172,87],"./ion-spinner.entry.js":[173,25],"./ion-split-pane-ios.entry.js":[174,88],"./ion-split-pane-md.entry.js":[175,89],"./ion-tab-bar_2-ios.entry.js":[176,72],"./ion-tab-bar_2-md.entry.js":[177,73],"./ion-tab_2.entry.js":[178,28],"./ion-text.entry.js":[179,74],"./ion-textarea-ios.entry.js":[180,75],"./ion-textarea-md.entry.js":[181,76],"./ion-toast-ios.entry.js":[182,77],"./ion-toast-md.entry.js":[183,78],"./ion-toggle-ios.entry.js":[184,23],"./ion-toggle-md.entry.js":[185,24],"./ion-virtual-scroll.entry.js":[186,90]};function a(e){if(!n.o(r,e))return Promise.resolve().then((function(){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}));var t=r[e],a=t[0];return n.e(t[1]).then((function(){return n(a)}))}a.keys=function(){return Object.keys(r)},a.id=85,e.exports=a},87:function(e,t,n){var r={"./ion-icon.entry.js":[190,93]};function a(e){if(!n.o(r,e))return Promise.resolve().then((function(){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}));var t=r[e],a=t[0];return n.e(t[1]).then((function(){return n(a)}))}a.keys=function(){return Object.keys(r)},a.id=87,e.exports=a},94:function(e,t,n){},95:function(e,t,n){}},[[75,9,12]]]);
//# sourceMappingURL=main.db89923d.chunk.js.map