<!-- для редактирования в VSCode установи расширение Markdown All In One -->
Было бы неплохо на swagger ui перенести доки

# рейтинг хостеров (Сервис Вконтакте)

- [рейтинг хостеров (Сервис Вконтакте)](#рейтинг-хостеров-сервис-вконтакте)
  - [API, использующее приложение](#api-использующее-приложение)
  - [Ошибки в методах](#ошибки-в-методах)
    - [app.init - инициализация приложения +](#appinit---инициализация-приложения-)
    - [app.GetRatingList - получения крактого списка лидеров](#appgetratinglist---получения-крактого-списка-лидеров)
    - [host.GetInfo - получения больше инфы для хостинга +](#hostgetinfo---получения-больше-инфы-для-хостинга-)
    - [host.GetRatings - получение всех **рейтингов с текстом** по хостеру](#hostgetratings---получение-всех-рейтингов-с-текстом-по-хостеру)
    - [host.GetComments - получение ответов на комментарии](#hostgetcomments---получение-ответов-на-комментарии)
    - [host.AddOrEditRating - добавить/редактировать **оценку**](#hostaddoreditrating---добавитьредактировать-оценку)
    - [host.AddAnswer - добавления комментария на отзыв](#hostaddanswer---добавления-комментария-на-отзыв)
    - [host.EditAnswer - редактирования ответа на **отзыв**](#hosteditanswer---редактирования-ответа-на-отзыв)
    - [host.SendUserReaction - метод для "редактирования" **кармы** **отзыва** или **метода**](#hostsenduserreaction---метод-для-редактирования-кармы-отзыва-или-метода)
    - [host.DeleteContent - удалить **коммент** или **отзыв**](#hostdeletecontent---удалить-коммент-или-отзыв)
    - [host.ReportContent - репорт отзыва или коммента](#hostreportcontent---репорт-отзыва-или-коммента)
    - [hostMembers.GetList - получение списка host_member](#hostmembersgetlist---получение-списка-host_member)
    - [hostMembers.Add - добавление host_member](#hostmembersadd---добавление-host_member)
    - [hostMembers.Delete - удаление host_member](#hostmembersdelete---удаление-host_member)
    - [Коды ошибок в error](#коды-ошибок-в-error)

## API, использующее приложение

[![API stability](https://img.shields.io/badge/API%20stability-1%20(Experimental)-red)](https://gist.github.com/isaacs/1776425)

Все запросы делать по адресу https://api.matveev.app/host_rate/request.php. Обязательные GET параметры в каждом из методов:

| name      | default        | description                  |
| --------- | -------------- | ---------------------------- |
| method    | **Обязателен** | Имя метода                   |
| vk_params | **Обязателен** | Все параметры, отдаваемые ВК |

- Любой метод **обязан** возвращать JSON (`{}` если метод ничего не должен возвращать)
- Дополнительные параметры в методах посылаются через **POST** метод
- Рейтинг, отзыв или оценка - одно и то же понятие. Только под ними находятся комментарии.
- Все рейтинги оцениваются по 10 бальной шкале

## Ошибки в методах

В случае, если в методе произошла ошибка, возвращается объект error:
```json5
{
    "error": {
        "code": number,
        "message": string,
        "description": string
    }
}
```

[Коды ошибок в error](#Коды-ошибок-в-error)

### app.init - инициализация приложения +

- Возвращает: 

```json5
{
    "user_type": "user" | "host_member" | "host_owner"
}
```

### app.GetRatingList - получения крактого списка лидеров

- Пользователь может вручную запросить новые данные

- нужны офсеты

- Возвращает:

```json5
{
    "host_id": number,
    "host_name": string,
    "host_site": string,
    "host_rating": number, //общий рейтинг, может быть дробным
}[] // - массив
```

### host.GetInfo - получения больше инфы для хостинга +

Параметры:

| name    | type   | default        | description |
| ------- | ------ | -------------- | ----------- |
| host_id | number | **Обязателен** | Имя метода  |

- Возвращает:

```json5
{
    "host_description": string, 
    "host_information": string, 
    "host_site": string,  
}
```

### host.GetRatings - получение всех **рейтингов с текстом** по хостеру

Параметры:

| name    | type   | default        | description |
| ------- | ------ | -------------- | ----------- |
| host_id | number | **Обязателен** | Имя метода  |

- нужны офсеты

- Возвращает:

Рейтинг самого пользователя отдавать самым первым. (пока не знаю как с комментами)

Сокращение типов:

- `CONTENT_GENERAL`:
```json5
  {
      
  }
```
- Метод возвращает:

```json5
{
    "rating": number,//общая оценка
    "id": number, // id рейтинга или коммента
    "time": number, //unix
    "user_id": number, // для ссылки на юзера?
    "user_full_name": string, //по идеи можешь не отправлять я вроде как сам могу узнавать у вк имя по id
    "reputation": number, // репутатиция (пользователи выбирают, насколько этот отзыв полезен),
    "text": string, //сам текст отзыва или комментария,
    "comments_number": number //кол-во ответов, если 0 тогда не будет кнопки загрузки комментов
}[] // - массив
```


### host.GetComments - получение ответов на комментарии

Параметры:

| name      | type   | default        | description                                           |
| --------- | ------ | -------------- | ----------------------------------------------------- |
| rating_id | number | **Обязателен** | К какому рейтингу хотим получить ответы (комментарии) |

- Метод возвращает:

```json5
{
    "is_hoster": boolean, // ответил ли host_member или host_owner
    "id": number, // id рейтинга или коммента
    "time": number, //unix
    "user_id": number, // для ссылки на юзера?
    "reputation": number, // репутатиция (пользователи выбирают, насколько этот отзыв полезен),
    "text": string //сам текст отзыва или комментария
}[] // - массив
```


### host.AddOrEditRating - добавить/редактировать **оценку**

Если есть рейтинг - редактируем, если нет - добавляем.

Параметры:

| name         | type   | default        | description                    |
| ------------ | ------ | -------------- | ------------------------------ |
| host_id      | number | **Обязателен** | К какому хостингу шлем коммент |
| rating       | number | **Обязателен** | Общий рейтинг                  |
| rate_support | number | **Обязателен** | Оценка поддержки               |
| rate_network | number | **Обязателен** | Оценка сети                    |
| rate_ram     | number | **Обязателен** | Оценка оперативной памяти      |
| rate_cpu     | number | **Обязателен** | Оценка процессора              |
| rate_billing | number | **Обязателен** | Оценка биллинг?                |
| content      | string | Не обязателен  | Текст отзыва                   |

### host.AddAnswer - добавления комментария на отзыв

Параметры:

| name    | type   | default        | description                         |
| ------- | ------ | -------------- | ----------------------------------- |
| rate_id | number | **Обязателен** | **Отзыв**, на который создаем ответ |
| content | string | **Обязателен** | Текст комментария (ответа на отзыв) |

### host.EditAnswer - редактирования ответа на **отзыв**

Параметры:

| name       | type   | default        | description                          |
| ---------- | ------ | -------------- | ------------------------------------ |
| comment_id | number | **Обязателен** | **Комментарий**, который редактируем |
| content    | string | **Обязателен** | Текст комментария                    |

### host.SendUserReaction - метод для "редактирования" **кармы** **отзыва** или **метода**

Параметры:

| name       | type                     | default        | description                               |
| ---------- | ------------------------ | -------------- | ----------------------------------------- |
| content_id | number                   | **Обязателен** | Указываем его, если хотим "оценить" отзыв |
| reaction   | "positive" \| "negative" | **Обязателен** | Реакция пользователя                      |

### host.DeleteContent - удалить **коммент** или **отзыв**

Все таки не знаю как правильней назвать метод.

Параметры (один из двух):

| name       | type   | default       | description                                            |
| ---------- | ------ | ------------- | ------------------------------------------------------ |
| host_id    | number | Не обязателен | Указываем его, если хотим удалить отзыв                |
| comment_id | number | Не обязателен | Указываем его, если хотим удалить **свой** комментарий |

### host.ReportContent - репорт отзыва или коммента

- Параметры:

| name       | type   | default        | description  |
| ---------- | ------ | -------------- | ------------ |
| content_id | number | **Обязателен** | Контент айди |


### hostMembers.GetList - получение списка host_member

Только для host_owner.

Возвращает:
```json5
{
    "user_id": number //user_full_name я вряд ли могу сам получать 
}[]
```

### hostMembers.Add - добавление host_member

Только для host_owner.

Параметры:

| name    | type   | default        | description        |
| ------- | ------ | -------------- | ------------------ |
| user_id | number | **Обязателен** | Id пользователя ВК |

### hostMembers.Delete - удаление host_member

Только для host_owner.

Параметры:

| name    | type   | default        | description        |
| ------- | ------ | -------------- | ------------------ |
| user_id | number | **Обязателен** | Id пользователя ВК |

### Коды ошибок в error

| номер ошибки | сообщение                   | что произошло                 |
| ------------ | --------------------------- | ----------------------------- |
| 1            | database connection is lost | Нет соединения с базой данных |
| 2            | invalid sign                | Неверная подпись              |
| 3            | invalid request             | Отпрален неверный запрос      |
